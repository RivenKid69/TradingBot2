# üîç –û–¢–ß–ï–¢ –ê–£–î–ò–¢–ê –°–ò–°–¢–ï–ú–´ –ü–†–ò–ó–ù–ê–ö–û–í TRADINGBOT2

**–î–∞—Ç–∞**: 2025-11-10
**–ó–∞–¥–∞—á–∞**: –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –æ—Ç —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ –º–æ–¥–µ–ª–∏
**–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ **–í–°–ï –ü–†–û–í–ï–†–ö–ò –ü–†–û–ô–î–ï–ù–´, –ù–ê–ô–î–ï–ù–´ –ò –ò–°–ü–†–ê–í–õ–ï–ù–´ 2 –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´**

---

## üìä –ö–†–ê–¢–ö–û–ï –†–ï–ó–Æ–ú–ï

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ –∞—É–¥–∏—Ç–∞ | –ü–æ—Å–ª–µ –∞—É–¥–∏—Ç–∞ | –ò–∑–º–µ–Ω–µ–Ω–∏–µ |
|---------|-----------|--------------|-----------|
| **N_FEATURES** | 51 | 56 | +5 |
| **EXT_NORM_DIM** | 16 | 21 | +5 |
| **–°–æ–∑–¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤** | 24 | 24 | 0 |
| **–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤** | 19 | 24 | +5 |
| **–ü–æ—Ç–µ—Ä—è–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤** | 5 | 0 | -5 |
| **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** | 79.2% | 100% | +20.8% |

---

## üéØ –ß–¢–û –ë–´–õ–û –°–î–ï–õ–ê–ù–û

### –≠–¢–ê–ü 1: –ü–†–û–í–ï–†–ö–ê –°–û–ó–î–ê–ù–ò–Ø –ü–†–ò–ó–ù–ê–ö–û–í ‚úÖ

**–§–∞–π–ª—ã**: `prepare_and_run.py`, `transformers.py`

–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —Å–æ–∑–¥–∞–Ω–∏–µ –≤—Å–µ—Ö —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:
- ‚úÖ SMA: 3 –æ–∫–Ω–∞ (5, 15, 60 –º–∏–Ω—É—Ç)
- ‚úÖ Returns: 3 –æ–∫–Ω–∞ (5, 15, 60 –º–∏–Ω—É—Ç)
- ‚úÖ RSI: 1 –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä (–ø–µ—Ä–∏–æ–¥ 14)
- ‚úÖ Yang-Zhang: 3 –æ–∫–Ω–∞ (24h, 168h, 720h)
- ‚úÖ Parkinson: 2 –æ–∫–Ω–∞ (24h, 168h)
- ‚úÖ GARCH: 3 –æ–∫–Ω–∞ (500m, 12h, 24h)
- ‚úÖ Taker Buy Ratio: 1 —Ç–µ–∫—É—â–µ–µ + 3 SMA (6h, 12h, 24h) + 3 momentum (1h, 6h, 12h)
- ‚úÖ CVD: 2 –æ–∫–Ω–∞ (24h, 168h)

**–ò–¢–û–ì–û: 24 –ø—Ä–∏–∑–Ω–∞–∫–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è** ‚úÖ

---

### –≠–¢–ê–ü 2: –ü–†–û–í–ï–†–ö–ê –ó–ê–ì–†–£–ó–ö–ò –ü–†–ò–ó–ù–ê–ö–û–í ‚ùå ‚Üí ‚úÖ

**–§–∞–π–ª**: `mediator.py:_extract_norm_cols()`

**–ü–†–û–ë–õ–ï–ú–ê 1 (–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø)**: –ü–æ—Ç–µ—Ä—è 5 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- –°–æ–∑–¥–∞–≤–∞–ª–æ—Å—å 24 –ø—Ä–∏–∑–Ω–∞–∫–∞, –∑–∞–≥—Ä—É–∂–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ 19
- 5 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ taker_buy_ratio —Å–æ–∑–¥–∞–≤–∞–ª–∏—Å—å, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å:
  - `taker_buy_ratio_sma_6h`
  - `taker_buy_ratio_sma_12h`
  - `taker_buy_ratio_momentum_1h`
  - `taker_buy_ratio_momentum_6h`
  - `taker_buy_ratio_momentum_12h`

**–†–ï–®–ï–ù–ò–ï**:
```python
# mediator.py:1010-1042
norm_cols = np.zeros(21, dtype=np.float32)  # –ë—ã–ª–æ 16, —Å—Ç–∞–ª–æ 21
# ... –¥–æ–±–∞–≤–ª–µ–Ω—ã 5 –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
norm_cols[16] = self._get_safe_float(row, "taker_buy_ratio_sma_6h", 0.0)
norm_cols[17] = self._get_safe_float(row, "taker_buy_ratio_sma_12h", 0.0)
norm_cols[18] = self._get_safe_float(row, "taker_buy_ratio_momentum_1h", 0.0)
norm_cols[19] = self._get_safe_float(row, "taker_buy_ratio_momentum_6h", 0.0)
norm_cols[20] = self._get_safe_float(row, "taker_buy_ratio_momentum_12h", 0.0)
```

---

### –≠–¢–ê–ü 3: –ü–†–û–í–ï–†–ö–ê –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò ‚úÖ

**–§–∞–π–ª**: `feature_config.py`

**–û–±–Ω–æ–≤–ª–µ–Ω–æ**:
```python
EXT_NORM_DIM = 21  # –ë—ã–ª–æ 16, —Å—Ç–∞–ª–æ 21
```

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Å—á–µ—Ç**:
- N_FEATURES = 3(bar) + 2(derived) + 13(indicators) + 3(micro) + 6(agent) + 5(metadata) + 21(external) + 2(token_meta) + 1(token) = **56** ‚úÖ

---

### –≠–¢–ê–ü 4: –ü–†–û–í–ï–†–ö–ê OBS_BUILDER ‚ùå ‚Üí ‚úÖ

**–§–∞–π–ª**: `obs_builder.pyx`

**–ü–†–û–ë–õ–ï–ú–ê 2 (–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø)**: –î–≤–æ–π–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
- norm_cols –ø—Ä–æ—Ö–æ–¥–∏–ª–∏ `tanh()` –≤ mediator.py
- –ó–∞—Ç–µ–º —Å–Ω–æ–≤–∞ `clip()` –≤ obs_builder.pyx
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

**–†–ï–®–ï–ù–ò–ï**:
```python
# mediator.py:1040-1042 (–£–ë–†–ê–ù tanh)
# NOTE: Normalization (tanh, clip) is applied in obs_builder.pyx
# to avoid double normalization
return norm_cols  # –ë–µ–∑ tanh!

# obs_builder.pyx:213 (–î–û–ë–ê–í–õ–ï–ù tanh)
feature_val = _clipf(tanh(norm_cols_values[i]), -3.0, 3.0)
```

–¢–µ–ø–µ—Ä—å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑** –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –º–µ—Å—Ç–µ.

---

### –≠–¢–ê–ü 5: –ü–†–û–í–ï–†–ö–ê ENVIRONMENT ‚úÖ

**–§–∞–π–ª**: `trading_patchnew.py:609-611`

```python
self.observation_space = spaces.Box(
    low=-np.inf, high=np.inf, shape=(N_FEATURES,), dtype=np.float32
)
```

N_FEATURES –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ `feature_config.make_layout()`, –ø–æ—ç—Ç–æ–º—É **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏–ª—Å—è –¥–æ 56**.

---

## üîß –í–ù–ï–°–ï–ù–ù–´–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø

### 1. mediator.py
```python
# –°—Ç—Ä–æ–∫–∏ 1010-1042
- norm_cols = np.zeros(16, dtype=np.float32)
+ norm_cols = np.zeros(21, dtype=np.float32)

# –î–æ–±–∞–≤–ª–µ–Ω—ã 5 –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (—Å—Ç—Ä–æ–∫–∏ 1034-1038)
+ norm_cols[16] = self._get_safe_float(row, "taker_buy_ratio_sma_6h", 0.0)
+ norm_cols[17] = self._get_safe_float(row, "taker_buy_ratio_sma_12h", 0.0)
+ norm_cols[18] = self._get_safe_float(row, "taker_buy_ratio_momentum_1h", 0.0)
+ norm_cols[19] = self._get_safe_float(row, "taker_buy_ratio_momentum_6h", 0.0)
+ norm_cols[20] = self._get_safe_float(row, "taker_buy_ratio_momentum_12h", 0.0)

# –£–±—Ä–∞–Ω–∞ –¥–≤–æ–π–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è (—Å—Ç—Ä–æ–∫–∞ 1034)
- norm_cols = np.tanh(norm_cols)
+ # NOTE: Normalization (tanh, clip) is applied in obs_builder.pyx
```

### 2. feature_config.py
```python
# –°—Ç—Ä–æ–∫–∞ 6
- EXT_NORM_DIM = 16
+ EXT_NORM_DIM = 21
```

### 3. obs_builder.pyx
```python
# –°—Ç—Ä–æ–∫–∞ 213
- feature_val = _clipf(norm_cols_values[i], -3.0, 3.0)
+ feature_val = _clipf(tanh(norm_cols_values[i]), -3.0, 3.0)
```

---

## üìù –°–û–ó–î–ê–ù–ù–´–ï –§–ê–ô–õ–´

1. **FEATURE_MAPPING_56.md** - –ø–æ–ª–Ω—ã–π –º–∞–ø–ø–∏–Ω–≥ –≤—Å–µ—Ö 56 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Å –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏
2. **tests/test_full_feature_pipeline_56.py** - –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Ç–µ—Å—Ç –≤—Å–µ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω–∞
3. **verify_56_features.py** - –ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
4. **AUDIT_REPORT.md** (—ç—Ç–æ—Ç —Ñ–∞–π–ª) - –æ—Ç—á–µ—Ç –∞—É–¥–∏—Ç–∞

---

## ‚úÖ –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ü–†–û–í–ï–†–û–ö

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ EXT_NORM_DIM = 21
- ‚úÖ N_FEATURES = 56
- ‚úÖ –°—É–º–º–∞ –±–ª–æ–∫–æ–≤ = 56

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- ‚úÖ –°–æ–∑–¥–∞–µ—Ç—Å—è 24 —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–∞
- ‚úÖ –í—Å–µ –∫–æ–ª–æ–Ω–∫–∏ –∏–º–µ—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞
- ‚úÖ –ù–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 3: –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- ‚úÖ norm_cols –∏–º–µ–µ—Ç —Ä–∞–∑–º–µ—Ä 21
- ‚úÖ –í—Å–µ 21 –ø—Ä–∏–∑–Ω–∞–∫ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ù–µ—Ç –¥–≤–æ–π–Ω–æ–π –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 4: –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ observation
- ‚úÖ observation –∏–º–µ–µ—Ç —Ä–∞–∑–º–µ—Ä 56
- ‚úÖ tanh –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –¥–æ–ø—É—Å—Ç–∏–º–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ
- ‚úÖ –ù–µ—Ç NaN –∏–ª–∏ Inf

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 5: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- ‚úÖ –í—Å–µ 24 —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
- ‚úÖ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å 100% (–±—ã–ª–æ 79.2%)
- ‚úÖ –ù–µ—Ç –ø–æ—Ç–µ—Ä—å –¥–∞–Ω–Ω—ã—Ö

---

## üìã –ü–û–õ–ù–´–ô –ú–ê–ü–ü–ò–ù–ì 56 –ü–†–ò–ó–ù–ê–ö–û–í

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ observation vector:
```
[0-2]   Bar level (3):          price, log_volume_norm, rel_volume
[3-15]  Indicators (13):        ma5, ma5_valid, ma20, ma20_valid, rsi14,
                                 macd, macd_signal, momentum, atr, cci, obv,
                                 bb_position, bb_width_rel
[16-17] Derived (2):            ret_1h, vol_proxy
[18-20] Microstructure (3):     ofi_proxy, qimb, micro_dev
[21-26] Agent state (6):        cash_ratio, position_ratio, vol_imbalance,
                                 trade_intensity, realized_spread, agent_fill_ratio
[27-31] Metadata (5):           is_high_importance, time_since_event, risk_off_flag,
                                 fear_greed_value, fear_greed_indicator
[32-52] External (21):          cvd_24h, cvd_168h, yang_zhang_24h, yang_zhang_168h,
                                 garch_12h, garch_24h, ret_15m, ret_60m, ret_5m,
                                 sma_60, yang_zhang_720h, parkinson_24h, parkinson_168h,
                                 garch_500m, taker_buy_ratio, taker_buy_ratio_sma_24h,
                                 taker_buy_ratio_sma_6h ‚úÖ, taker_buy_ratio_sma_12h ‚úÖ,
                                 taker_buy_ratio_momentum_1h ‚úÖ, taker_buy_ratio_momentum_6h ‚úÖ,
                                 taker_buy_ratio_momentum_12h ‚úÖ
[53-54] Token meta (2):         num_tokens_norm, token_id_norm
[55]    Token (1):               token[0]
```

‚úÖ = –î–æ–±–∞–≤–ª–µ–Ω–æ –≤ —ç—Ç–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏

–ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. `FEATURE_MAPPING_56.md`

---

## ‚ö†Ô∏è –û–°–¢–ê–í–®–ò–ï–°–Ø –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–Ø (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)

1. **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç MarketSimulator**: 8 –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ (macd, macd_signal, momentum, atr, cci, obv, bb_lower, bb_upper) –∑–∞–≤–∏—Å—è—Ç –æ—Ç `sim` –æ–±—ä–µ–∫—Ç–∞. –ï—Å–ª–∏ `sim=None`, –æ–Ω–∏ —Ä–∞–≤–Ω—ã 0.0. –≠—Ç–æ –∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã.

2. **–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –Ω–∞–∑–≤–∞–Ω–∏–π**: `ma20` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `sma_15` –≤–º–µ—Å—Ç–æ `sma_20`. –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—É—Ç–∞–Ω–∏—Ü–∞, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ.

3. **–†–∞–∑–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ NaN**: ma5‚Üí0.0, rsi‚Üí50.0. –≠—Ç–æ –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ (—Ä–∞–∑–Ω—ã–µ defaults –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤).

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### –í—ã–ø–æ–ª–Ω–µ–Ω–æ –≤ —ç—Ç–æ–º –∫–æ–º–º–∏—Ç–µ:
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã 5 –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –¥–≤–æ–π–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (EXT_NORM_DIM, N_FEATURES)
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã —Ç–µ—Å—Ç—ã –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏

### –ù–∞ –±—É–¥—É—â–µ–µ (–Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç):
- –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å `ma20`‚Üí`ma15` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `sma_20` –¥–ª—è —è—Å–Ω–æ—Å—Ç–∏
- –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –Ω–∞–ª–∏—á–∏—è –≤—Å–µ—Ö 21 –∫–æ–ª–æ–Ω–æ–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ DataFrame
- –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É NaN –∑–Ω–∞—á–µ–Ω–∏–π
- –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –≤ `transformers.py` –≤–º–µ—Å—Ç–æ `MarketSimulator`

---

## üì¶ –ö–ê–ö –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:
```bash
# –° pytest (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
pytest tests/test_full_feature_pipeline_56.py -v

# –ë–µ–∑ pytest
python verify_56_features.py
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
```python
from feature_config import N_FEATURES, EXT_NORM_DIM
print(f"N_FEATURES = {N_FEATURES}")  # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 56
print(f"EXT_NORM_DIM = {EXT_NORM_DIM}")  # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 21
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ observation:
```python
obs, _, _, _, _ = env.reset()
assert obs.shape == (56,), f"Expected (56,), got {obs.shape}"
assert np.all(np.isfinite(obs)), "Observation contains NaN or Inf"
```

---

## üèÜ –ò–¢–û–ì–ò

### –ù–∞–π–¥–µ–Ω–æ –ø—Ä–æ–±–ª–µ–º: **2 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ, 3 –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è**

1. ‚ùå **–ü–æ—Ç–µ—Ä—è 5 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤** ‚Üí ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**
2. ‚ùå **–î–≤–æ–π–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è** ‚Üí ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**
3. ‚ö†Ô∏è –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç MarketSimulator (–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å)
4. ‚ö†Ô∏è –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –Ω–∞–∑–≤–∞–Ω–∏–π ma20/sma_15 (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)
5. ‚ö†Ô∏è –†–∞–∑–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ NaN (–Ω–∞–º–µ—Ä–µ–Ω–Ω–æ)

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —Ñ–∞–π–ª–æ–≤: **3**
- `mediator.py` (+5 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, -–¥–≤–æ–π–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è)
- `feature_config.py` (EXT_NORM_DIM 16‚Üí21)
- `obs_builder.pyx` (+tanh –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è)

### –°–æ–∑–¥–∞–Ω–æ —Ñ–∞–π–ª–æ–≤: **4**
- `FEATURE_MAPPING_56.md` (–ø–æ–ª–Ω—ã–π –º–∞–ø–ø–∏–Ω–≥)
- `tests/test_full_feature_pipeline_56.py` (–∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Ç–µ—Å—Ç)
- `verify_56_features.py` (–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Å–∫—Ä–∏–ø—Ç)
- `AUDIT_REPORT.md` (—ç—Ç–æ—Ç –æ—Ç—á–µ—Ç)

### –†–µ–∑—É–ª—å—Ç–∞—Ç:
üéâ **–í–°–ï –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ –ò–°–ü–†–ê–í–õ–ï–ù–´**
‚úÖ **–°–ò–°–¢–ï–ú–ê –ü–†–ò–ó–ù–ê–ö–û–í –†–ê–ë–û–¢–ê–ï–¢ –ö–û–†–†–ï–ö–¢–ù–û**
üìä **–≠–§–§–ï–ö–¢–ò–í–ù–û–°–¢–¨ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø: 100%**

---

## üìû –ö–û–ù–¢–ê–ö–¢–´

–ü—Ä–∏ –≤–æ–ø—Ä–æ—Å–∞—Ö –ø–æ –∞—É–¥–∏—Ç—É –∏–ª–∏ –Ω–∞–π–¥–µ–Ω–Ω—ã–º –ø—Ä–æ–±–ª–µ–º–∞–º:
- –°–º. –¥–µ—Ç–∞–ª—å–Ω—ã–π –º–∞–ø–ø–∏–Ω–≥: `FEATURE_MAPPING_56.md`
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã: `python verify_56_features.py`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ commit history –¥–ª—è –¥–µ—Ç–∞–ª–µ–π –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

**–ö–æ–Ω–µ—Ü –æ—Ç—á–µ—Ç–∞**
