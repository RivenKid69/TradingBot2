# configs/realtime.yaml
market: "futures"             # "spot" или "futures" (используется для бэкапа REST в backfill)
# symbols are loaded from data/universe/symbols.json
interval: "4h"  # Changed from 1m to 4h for migration

max_signals_per_sec: 5.0
backoff_base_s: 2.0
max_backoff_s: 60.0

calibrator:
  enabled: false
  path: "models/calibrator.json"
  apply_to: "score"
  out_field: "score_calibrated"

# See ../docs/no_trade.md for details
no_trade:
  funding_buffer_min: 5
  daily_utc:
    - "00:00-00:05"
    - "08:00-08:05"
    - "16:00-16:05"
  custom_ms: []
  dynamic_guard:
    enable: false
    sigma_window: 120
    atr_window: 14
    vol_abs: null
    vol_pctile: 0.99
    spread_abs_bps: null
    spread_pctile: 0.99
    hysteresis: 0.1
    cooldown_bars: 10
    log_reason: true

guards:
  min_history_bars: 180
  gap_cooldown_bars: 10
  gap_threshold_ms: 21600000  # 1.5 * 4h = 6 hours (changed from 90000 = 1.5m for 1m timeframe)

policy:
  module: "strategies.momentum"
  class: "MomentumStrategy"
  params:
    lookback: 5
    enter_threshold: 0.0  # enter >= exit; falls back to legacy ``threshold`` when set
    exit_threshold: 0.0   # exit hysteresis threshold; uses ``threshold`` as fallback
    order_qty: 0.1  # доля позиции

features:
  lookbacks_prices: [240, 720, 1440, 12000]  # 4h timeframe: 4h, 12h, 24h, 200h (changed from 1m: 5m, 15m, 60m)
  rsi_period: 14
  # Yang-Zhang volatility windows (in minutes) for 4h: 48h, 7d, 30d (changed from 1m: 24h, 7d, 30d)
  yang_zhang_windows: [2880, 10080, 43200]
  # Parkinson volatility windows (in minutes) for 4h: 48h, 7d (changed from 1m: 24h, 7d)
  parkinson_windows: [2880, 10080]

out_csv: "logs/signals.csv"
min_signal_gap_s: 300
backfill_on_gap: true
