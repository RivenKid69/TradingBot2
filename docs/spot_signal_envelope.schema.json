{
  "$defs": {
    "SpotSignalDeltaParticipationPayload": {
      "description": "Spot signal describing a delta weight adjustment with optional participation hints.",
      "properties": {
        "delta_weight": {
          "description": "Relative change in portfolio weight (positive increases exposure).",
          "title": "Delta Weight",
          "type": "number"
        },
        "economics": {
          "$ref": "#/$defs/SpotSignalEconomics"
        },
        "kind": {
          "const": "delta_weight",
          "default": "delta_weight",
          "title": "Kind",
          "type": "string"
        },
        "max_participation": {
          "anyOf": [
            {
              "minimum": 0.0,
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional cap on participation used for scheduling child orders.",
          "title": "Max Participation"
        },
        "participation": {
          "anyOf": [
            {
              "minimum": 0.0,
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional participation hint (0..1) for POV style execution.",
          "title": "Participation"
        },
        "twap": {
          "anyOf": [
            {
              "$ref": "#/$defs/SpotSignalTwapConfig"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional configuration for TWAP style slicing."
        }
      },
      "required": [
        "economics",
        "delta_weight"
      ],
      "title": "SpotSignalDeltaParticipationPayload",
      "type": "object"
    },
    "SpotSignalEconomics": {
      "description": "Estimated economics for a spot rebalance signal.",
      "properties": {
        "act_now": {
          "description": "Whether the rebalance should execute immediately.",
          "title": "Act Now",
          "type": "boolean"
        },
        "cost_bps": {
          "description": "Estimated total cost in basis points.",
          "title": "Cost Bps",
          "type": "number"
        },
        "edge_bps": {
          "description": "Gross signal edge in basis points.",
          "title": "Edge Bps",
          "type": "number"
        },
        "net_bps": {
          "description": "Net edge after subtracting costs.",
          "title": "Net Bps",
          "type": "number"
        },
        "turnover_usd": {
          "description": "Expected turnover generated by the signal in USD.",
          "minimum": 0.0,
          "title": "Turnover Usd",
          "type": "number"
        },
        "impact": {
          "description": "Estimated participation-driven impact component in basis points.",
          "minimum": 0.0,
          "title": "Impact",
          "type": "number"
        },
        "impact_mode": {
          "default": "model",
          "description": "Mode describing how the impact estimate was produced.",
          "title": "Impact Mode",
          "type": "string"
        }
      },
      "required": [
        "edge_bps",
        "cost_bps",
        "net_bps",
        "turnover_usd",
        "act_now"
      ],
      "title": "SpotSignalEconomics",
      "type": "object"
    },
    "SpotSignalTargetWeightPayload": {
      "description": "Spot signal targeting an absolute portfolio weight.",
      "properties": {
        "economics": {
          "$ref": "#/$defs/SpotSignalEconomics"
        },
        "kind": {
          "const": "target_weight",
          "default": "target_weight",
          "title": "Kind",
          "type": "string"
        },
        "target_weight": {
          "description": "Desired portfolio weight.",
          "maximum": 1.0,
          "minimum": 0.0,
          "title": "Target Weight",
          "type": "number"
        }
      },
      "required": [
        "economics",
        "target_weight"
      ],
      "title": "SpotSignalTargetWeightPayload",
      "type": "object"
    },
    "SpotSignalTwapConfig": {
      "description": "Optional slicing configuration for delta-style payloads.",
      "properties": {
        "interval_ms": {
          "anyOf": [
            {
              "minimum": 0,
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Interval between slices in milliseconds. Overrides interval_s when provided.",
          "title": "Interval Ms"
        },
        "interval_s": {
          "anyOf": [
            {
              "exclusiveMinimum": 0.0,
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Interval between slices in seconds. Mutually exclusive with interval_ms.",
          "title": "Interval S"
        },
        "max_participation": {
          "anyOf": [
            {
              "minimum": 0.0,
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Maximum participation (fraction of ADV) per slice.",
          "title": "Max Participation"
        },
        "parts": {
          "default": 1,
          "description": "Number of slices to execute.",
          "minimum": 1,
          "title": "Parts",
          "type": "integer"
        }
      },
      "title": "SpotSignalTwapConfig",
      "type": "object"
    }
  },
  "description": "Wrapper adding metadata and optional signature to a spot signal payload.",
  "properties": {
    "bar_close_ms": {
      "description": "Bar close timestamp in milliseconds.",
      "minimum": 0,
      "title": "Bar Close Ms",
      "type": "integer"
    },
    "expires_at_ms": {
      "description": "Signal expiry timestamp in milliseconds.",
      "minimum": 0,
      "title": "Expires At Ms",
      "type": "integer"
    },
    "payload": {
      "anyOf": [
        {
          "$ref": "#/$defs/SpotSignalTargetWeightPayload"
        },
        {
          "$ref": "#/$defs/SpotSignalDeltaParticipationPayload"
        }
      ],
      "title": "Payload"
    },
    "signature": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "description": "Optional HMAC-SHA256 signature.",
      "title": "Signature"
    },
    "symbol": {
      "description": "Trading symbol this signal applies to.",
      "title": "Symbol",
      "type": "string"
    },
    "version": {
      "const": "v1",
      "default": "v1",
      "title": "Version",
      "type": "string"
    }
  },
  "required": [
    "symbol",
    "bar_close_ms",
    "expires_at_ms",
    "payload"
  ],
  "title": "SpotSignalEnvelope",
  "type": "object"
}
